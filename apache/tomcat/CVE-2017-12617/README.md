# Apache Tomcat RCE Via JSP Upload (CVE-2017-12617)

This directory contains the Dockerfile that can be used to build an
Apache Tomcat instance vulnerable to CVE-2017-12617.

Specifically, the dockerfile takes an optional build argument named
`CONFIG`. If this argument is set to the value `vuln`, the build will
produce a vulnerable service. In all other cases, the build will
produce a non vulnerable service.

In the vulnerable configuration, the `readonly` property in `web.xml`
is set to `false`. To build a vulnerable version of the service
proceed as follows.

```sh
docker build --build-arg CONFIG=vuln -t tomcat .
```

In the non vulnerable configuration, the `readonly` property in
`web.xml` is set to `true`. To build a non vulnerable version of the
service proceed as follows.

```sh
docker build -t tomcat .
```

Regardless of how the image has been built, to start the container
proceed as follows.

```sh
docker run --name tomcat --rm -d -p127.0.0.1:8080:8080 tomcat
```

The container is named `tomcat` and will listen to the endpoint
`127.0.0.1:8080`. Once the testing has been done, stop the container
with

```sh
docker stop tomcat
```

**Apache Version**|**Affected Release Versions**
:-----:|:-----:|
Apache Tomcat 9|9.0.0 M1 to 9.0.0
Apache Tomcat 8|8.0.0 RC1 to 8.0.46 and 8.5.0 to 8.5.22
Apache Tomcat 7|7.0.0 to 7.0.81

## References
* https://nvd.nist.gov/vuln/detail/cve-2017-12617
* https://www.exploit-db.com/exploits/42966
