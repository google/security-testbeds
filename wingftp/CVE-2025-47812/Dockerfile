# Use a minimal base image
FROM ubuntu:22.04

# Set non-interactive mode
ENV DEBIAN_FRONTEND=noninteractive

# Install required packages
RUN apt-get update && apt-get install -y \
    tar \
    curl \
    && rm -rf /var/lib/apt/lists/*


# Copy WingFTP archive and setup script
COPY wftpserver-linux-64bit.tar.gz /tmp/
COPY setup-target.sh /opt/wftpserver/

# Extract WingFTP into /opt/wftpserver
RUN tar -xzf /tmp/wftpserver-linux-64bit.tar.gz -C /opt/ && \
    rm -f /tmp/wftpserver-linux-64bit.tar.gz && \
    chmod +x /opt/wftpserver/setup-target.sh && \
    chmod +x /opt/wftpserver/wftpserver

# Set working directory
WORKDIR /opt/wftpserver

# Expose ports
EXPOSE 5466 5467

# Run the setup script
ENTRYPOINT ["./setup-target.sh"]
