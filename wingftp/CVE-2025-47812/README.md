# WingFTP Testbed for CVE-2025-47812

A comprehensive Docker testbed for WingFTP server that automates deployment, configuration, and provisioning for testing tsunami scanner plugin.

## Overview

This testbed creates a fully containerized WingFTP environment with automated setup, pre-configured admin access, and a demo domain with anonymous user access. The setup is optimized for rapid deployment and testing scenarios.

## Architecture

### Docker Image Components


**Application Layer**
- **WingFTP Server**: Extracted to `/opt/wftpserver/`
- **Configuration Management**: Automated XML-based admin and domain setup
- **Service Orchestration**: Background process management with health checks

### Port Configuration

| Port | Service | Purpose |
|------|---------|---------|
| `5466` | Admin Web UI | Management console and configuration interface |
| `5467` | Domain Controller | Primary domain web interface for user access |

## Setup Process

### Phase 1: Infrastructure Setup
- Extracts WingFTP server binaries and makes them executable
- Configures directory structure and permissions
- Initializes logging and runtime directories

### Phase 2: Administrative Configuration
- **Admin Credentials Setup**
  - Username: `administrator`
  - Password: `wingftp` (MD5 hashed in configuration)
  - Binds admin interface to port `5466`
- **Security Configuration**: Applies minimal security settings for testing environment

### Phase 3: Domain Provisioning
- **Background Service**: Launches WingFTP server daemon
- **Readiness Verification**: Polls for service availability
- **Session Management**: Establishes authenticated admin session via `UIDADMIN` cookie
- **Domain Creation**: 
  - Domain Name: `poc`
  - Binding: All network interfaces
  - Protocol Configuration: HTTP on port `5467` (FTP/FTPS disabled)

### Phase 4: User Provisioning
- **Anonymous User**: Created with standard access permissions
- **Default Limits**: Configured for testing scenarios
- **Access Controls**: Relaxed restrictions for development/testing

## Quick Start

### Prerequisites
- Docker Engine installed and running
- Required files in build context:
  - `wftpserver-linux-64bit.tar.gz`
  - `setup-target.sh`

### Deployment Commands

```bash
# Build the testbed image
docker build -t wingftp-testbed .

# Run with port mapping
docker run --rm -p 5466:5466 -p 5467:5467 --name wingftp wingftp-testbed

# Alternative: Run in detached mode
docker run -d -p 5466:5466 -p 5467:5467 --name wingftp wingftp-testbed

# View logs
docker logs -f wingftp
```

## Access Points

### Administrative Interface
- **URL**: `http://localhost:5466`
- **Username**: `administrator`
- **Password**: `wingftp`

### Domain Web Interface
- **URL**: `http://localhost:5467`
- **Access**: Anonymous user enabled

## Testing

### CVE-2025-47812 Exploitation

Execute the provided exploit script against the running testbed:

```bash
# Ensure testbed is running
docker ps | grep wingftp

# Run exploit against target
python3 exploit.py
```
